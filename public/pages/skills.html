<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>스킬 &amp; 모델 오류 - OpenClaw Guide</title>
  <link rel="stylesheet" href="../css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>
</head>
<body>
    <header class="mobile-header" id="mobileHeader">
      <button class="hamburger" id="hamburgerBtn" aria-label="메뉴 열기">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <span class="mobile-title">OpenClaw Guide</span>
    </header><div class="sidebar-overlay" id="sidebarOverlay"></div>
  <div class="layout">
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <a href="../index.html" class="sidebar-logo">
          <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          OpenClaw <span>Guide</span>
        </a>
        <button class="sidebar-close" id="sidebarClose" aria-label="메뉴 닫기">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      </div>
      
      <nav>
        <ul class="sidebar-nav">
          <li><a href="../index.html">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
            홈
          </a></li>
        </ul>
        
        <div class="sidebar-section">카테고리</div>
        <ul class="sidebar-nav">
          <li><a href="windows.html">1. Windows 전용 오류</a></li>
          <li><a href="macos.html">2. macOS 전용 오류</a></li>
          <li><a href="linux.html">3. Linux 전용 오류</a></li>
          <li><a href="virtualenv.html">4. 가상환경 설정 오류</a></li>
          <li><a href="common.html">5. 공통 오류</a></li>
          <li><a href="oauth.html">6. 인증 (OAuth) 오류</a></li>
          <li><a href="gateway.html">7. 게이트웨이 접속 오류</a></li>
          <li><a href="channels.html">8. 채널 통합 오류</a></li>
          <li><a href="client.html">9. 클라이언트 연결 오류</a></li>
          <li><a href="runtime.html">10. 런타임 오류</a></li>
          <li><a href="browser.html">11. 브라우저 도구 오류</a></li>
          <li><a href="channels-ext.html">12. 채널 확장 오류</a></li>
          <li><a href="skills.html" class="active">13. 스킬 &amp; 모델 오류</a></li>
        </ul>
        
        <div class="sidebar-section">리소스</div>
        <ul class="sidebar-nav">
          <li><a href="https://github.com/anthropics/openclaw" target="_blank" rel="noopener">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>
            GitHub
          </a></li>
          <li><a href="https://open.kakao.com/o/gugo7tCh" target="_blank" rel="noopener">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
            VoidLight 채팅방
          </a></li>
        </ul>
      </nav>
    </aside>
    <main class="main">
      <h1>스킬 &amp; 모델 오류</h1>
      <p class="page-subtitle">6개의 오류 유형 | 총 16개의 해결 방법</p>
      
      <div class="search-bar">
        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input type="text" id="searchInput" placeholder="오류 검색..." class="search-input">
      </div>

      <div class="accordion">
        <div class="accordion-item">
          <div class="accordion-header" onclick="toggleAccordion(this)">
            <div class="accordion-title-row">
              <span class="badge badge-medium">보통</span>
              <h2>ClawHub 스킬 설치 실패</h2>
            </div>
            <div class="accordion-meta">
              <span class="solve-time">5분</span>
              <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
          </div>
          <div class="accordion-body">
            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                증상
              </h3>
              <ul class="symptom-list">
                <li>clawhub install 실행 시 에러</li>
                <li>스킬 폴더가 생성되지 않음</li>
                <li>설치된 스킬이 에이전트에 로드되지 않음</li>
                <li>clawhub login 인증 실패</li>
              </ul>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                원인
              </h3>
              <div class="cause-block">
                <p>ClawHub CLI가 설치되지 않았거나, 인증이 만료되었거나, 스킬 slug가 잘못되었습니다. 설치된 스킬은 &lt;workspace&gt;/skills에 저장되며, 다음 세션부터 로드됩니다. 또한 같은 이름의 스킬이 여러 위치에 있으면 우선순위에 따라 충돌할 수 있습니다.</p>
              </div>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
                해결 방법
              </h3>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 A: ClawHub CLI 설치 및 인증</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code># ClawHub CLI 설치
npm install -g clawhub

# 로그인 (브라우저 인증)
clawhub login

# 또는 토큰으로 로그인
clawhub login --token &lt;your-token&gt;

# 스킬 검색 및 설치
clawhub search 'calendar'
clawhub install &lt;skill-slug&gt;

# 설치된 스킬 확인
clawhub list</code></pre>
                </div>
              </div>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 B: 스킬 로드 확인 및 업데이트</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code># 스킬 로드 위치 우선순위:
# 1. &lt;workspace&gt;/skills (최고 우선)
# 2. ~/.openclaw/skills (공유)
# 3. 번들 스킬 (최저 우선)

# 스킬 상태 확인
openclaw doctor  # Skills status 섹션 확인

# 모든 스킬 업데이트
clawhub update --all

# 새 세션 시작 (스킬 리로드)
# 채팅에서 /new 전송</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <div class="accordion-header" onclick="toggleAccordion(this)">
            <div class="accordion-title-row">
              <span class="badge badge-high">심각</span>
              <h2>모델 변경 오류 (잘못된 모델명 / API 키 누락)</h2>
            </div>
            <div class="accordion-meta">
              <span class="solve-time">5분</span>
              <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
          </div>
          <div class="accordion-body">
            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                증상
              </h3>
              <ul class="symptom-list">
                <li>'Unknown model: anthropic/claude-haiku-3-5' 에러</li>
                <li>'model not allowed' 에러</li>
                <li>'All models failed' 에러</li>
                <li>모델 변경 후 응답이 오지 않음</li>
              </ul>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                원인
              </h3>
              <div class="cause-block">
                <p>OpenClaw은 보안상 오래된/취약한 모델을 의도적으로 거부합니다. agents.defaults.models가 allowlist로 설정되어 있으면 목록에 없는 모델은 사용할 수 없습니다. 또한 해당 프로바이더의 API 키가 없거나 만료된 경우 모든 모델이 실패합니다.</p>
              </div>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
                해결 방법
              </h3>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 A: 사용 가능한 모델 확인 및 변경</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code># 사용 가능한 모델 목록 확인
openclaw models list
openclaw models scan

# 모델 상태 확인
openclaw models status

# 모델 allowlist 확인
openclaw config get agents.defaults.models

# 채팅에서 모델 변경
# /model &lt;provider/model-name&gt;
# /models  # 사용 가능한 모델 브라우징</code></pre>
                </div>
              </div>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 B: 프로바이더 인증 확인</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code># 프로바이더별 인증 상태 확인
openclaw models status
openclaw status --deep

# Anthropic API 키 재설정
openclaw models auth setup-token --provider anthropic

# 또는 환경 변수로:
export ANTHROPIC_API_KEY=sk-ant-...

# 게이트웨이 재시작
openclaw gateway restart</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <div class="accordion-header" onclick="toggleAccordion(this)">
            <div class="accordion-title-row">
              <span class="badge badge-medium">보통</span>
              <h2>MCP 도구 연결 실패</h2>
            </div>
            <div class="accordion-meta">
              <span class="solve-time">10분</span>
              <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
          </div>
          <div class="accordion-body">
            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                증상
              </h3>
              <ul class="symptom-list">
                <li>MCP 서버에 연결할 수 없음</li>
                <li>도구 호출 시 타임아웃</li>
                <li>MCP 도구가 도구 목록에 표시되지 않음</li>
                <li>JSON-RPC 통신 에러</li>
              </ul>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                원인
              </h3>
              <div class="cause-block">
                <p>MCP(Model Context Protocol) 도구는 외부 서버와 JSON-RPC로 통신합니다. MCP 서버가 실행되지 않았거나, 연결 URL이 잘못되었거나, 도구 스키마가 호환되지 않으면 연결이 실패합니다.</p>
              </div>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
                해결 방법
              </h3>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 A: MCP 서버 상태 확인</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code># MCP 서버가 실행 중인지 확인
# 설정 파일에서 MCP 설정 확인
cat ~/.openclaw/openclaw.json | grep -A10 'mcp'

# 게이트웨이 로그에서 MCP 관련 에러 확인
openclaw logs --follow | grep -i 'mcp\|tool\|rpc'

# 도구 상태 확인
openclaw status --deep</code></pre>
                </div>
              </div>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 B: MCP 도구 스키마 호환성</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code># Cloud Code Assist API의 경우 엄격한 JSON Schema 필요
# 지원되지 않는 키워드 피하기:
#   anyOf, oneOf, allOf, patternProperties
#   additionalProperties, minLength, maxLength, format

# 최상위 스키마는 type: 'object' + properties + 간단한 enum만 사용

# OpenClaw을 최신 버전으로 업데이트 (스키마 정규화 포함)
npm install -g openclaw@latest
openclaw gateway restart</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <div class="accordion-header" onclick="toggleAccordion(this)">
            <div class="accordion-title-row">
              <span class="badge badge-medium">보통</span>
              <h2>Agent failed: Unknown model (오래된/보안 취약 모델 거부)</h2>
            </div>
            <div class="accordion-meta">
              <span class="solve-time">5분분</span>
              <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
          </div>
          <div class="accordion-body">
            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                증상
              </h3>
              <ul class="symptom-list">
                <li>Agent failed before reply: Unknown model: anthropic/claude-haiku-3-5</li>
              </ul>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                원인
              </h3>
              <div class="cause-block">
                <p>확인 중</p>
              </div>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
                해결 방법
              </h3>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 A: 최신 모델로 변경</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code>최신 모델로 변경: openclaw models list로 사용 가능한 모델 확인</code></pre>
                </div>
              </div>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 B: openclaw models scan으로 지원 모델 스캔</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code>openclaw models scan으로 지원 모델 스캔</code></pre>
                </div>
              </div>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 C: 게이트웨이 로그에서 상세 실패 사유 확인</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code>게이트웨이 로그에서 상세 실패 사유 확인</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <div class="accordion-header" onclick="toggleAccordion(this)">
            <div class="accordion-title-row">
              <span class="badge badge-medium">보통</span>
              <h2>Unknown model: minimax/MiniMax-M2.1</h2>
            </div>
            <div class="accordion-meta">
              <span class="solve-time">5분분</span>
              <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
          </div>
          <div class="accordion-body">
            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                증상
              </h3>
              <ul class="symptom-list">
                <li>Unknown model: minimax/MiniMax-M2.1</li>
              </ul>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                원인
              </h3>
              <div class="cause-block">
                <p>확인 중</p>
              </div>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
                해결 방법
              </h3>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 A: 2026.1.12 이상으로 업그레이드 후 게이트웨이 재시작</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code>2026.1.12 이상으로 업그레이드 후 게이트웨이 재시작</code></pre>
                </div>
              </div>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 B: MiniMax 프로바이더 설정 또는 API 키 확인</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code>MiniMax 프로바이더 설정 또는 API 키 확인</code></pre>
                </div>
              </div>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 C: 정확한 모델 ID 사용 (대소문자 구분)</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code>정확한 모델 ID 사용 (대소문자 구분): minimax/MiniMax-M2.1</code></pre>
                </div>
              </div>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 D: openclaw models list로 사용 가능한 모델 확인</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code>openclaw models list로 사용 가능한 모델 확인</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <div class="accordion-header" onclick="toggleAccordion(this)">
            <div class="accordion-title-row">
              <span class="badge badge-medium">보통</span>
              <h2>Cloud Code Assist API error: invalid tool schema (400)</h2>
            </div>
            <div class="accordion-meta">
              <span class="solve-time">5분분</span>
              <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
          </div>
          <div class="accordion-body">
            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                증상
              </h3>
              <ul class="symptom-list">
                <li>Cloud Code Assist API error: invalid tool schema (400)</li>
              </ul>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                원인
              </h3>
              <div class="cause-block">
                <p>확인 중</p>
              </div>
            </div>

            <div class="error-section">
              <h3>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>
                해결 방법
              </h3>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 A: OpenClaw 업데이트 (main에서 스키마 스크러버 포함)</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code>OpenClaw 업데이트 (main에서 스키마 스크러버 포함)</code></pre>
                </div>
              </div>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 B: anyOf/oneOf/allOf, patternProperties, additionalProperties 등</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code>anyOf/oneOf/allOf, patternProperties, additionalProperties 등 미지원 키워드 사용 금지</code></pre>
                </div>
              </div>
              <div class="solution-card">
                <div class="solution-header">
                  <h4>방법 C: 커스텀 도구 정의 시 type</h4>
                  <div class="trust-level">
                    <span class="trust-label">신뢰도</span>
                    <span class="trust-stars"><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg class="star filled" viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                  </div>
                </div>
                <div class="code-block">
                  <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                  </div>
                  <pre><code>커스텀 도구 정의 시 type: object + properties + simple enums 유지</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <footer class="site-footer">
        <div class="footer-content">
          <p>OpenClaw Error Guide vv3.0 | 최종 업데이트: 2026-02-10</p>
          <div class="footer-links">
            <a href="https://github.com/anthropics/openclaw" target="_blank" rel="noopener">GitHub</a>
            <a href="https://openclaw.ai" target="_blank" rel="noopener">OpenClaw</a>
            <a href="https://open.kakao.com/o/gugo7tCh" target="_blank" rel="noopener">VoidLight 채팅방</a>
          </div>
        </div>
      </footer>
    </main>
  </div>
    <button class="back-to-top" id="backToTop" aria-label="맨 위로">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="18 15 12 9 6 15"/></svg>
    </button>
  <script>
    // Copy code
    function copyCode(btn) {
      const pre = btn.closest('.code-block').querySelector('pre');
      const code = pre.textContent;
      navigator.clipboard.writeText(code).then(() => {
        btn.textContent = '완료';
        setTimeout(() => btn.textContent = '복사', 2000);
      });
    }

    // Accordion toggle
    function toggleAccordion(header) {
      const item = header.parentElement;
      const isOpen = item.classList.contains('open');
      // Close all in same parent
      item.parentElement.querySelectorAll('.accordion-item.open').forEach(el => {
        if (el !== item) el.classList.remove('open');
      });
      item.classList.toggle('open', !isOpen);
    }

    // Mobile sidebar
    const hamburger = document.getElementById('hamburgerBtn');
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebarOverlay');
    const closeBtn = document.getElementById('sidebarClose');
    
    function openSidebar() {
      sidebar.classList.add('open');
      overlay.classList.add('show');
      document.body.style.overflow = 'hidden';
    }
    function closeSidebar() {
      sidebar.classList.remove('open');
      overlay.classList.remove('show');
      document.body.style.overflow = '';
    }
    
    if (hamburger) hamburger.addEventListener('click', openSidebar);
    if (overlay) overlay.addEventListener('click', closeSidebar);
    if (closeBtn) closeBtn.addEventListener('click', closeSidebar);

    // Back to top
    const backToTop = document.getElementById('backToTop');
    const mainEl = document.querySelector('.main');
    if (mainEl && backToTop) {
      mainEl.addEventListener('scroll', () => {
        backToTop.classList.toggle('show', mainEl.scrollTop > 400);
      });
      backToTop.addEventListener('click', () => {
        mainEl.scrollTo({ top: 0, behavior: 'smooth' });
      });
    }

    // Fuzzy Search (Fuse.js)
    const searchInput = document.getElementById('searchInput');
    if (searchInput && typeof Fuse !== 'undefined') {
      const items = Array.from(document.querySelectorAll('.accordion-item, .search-target'));
      const fuseList = items.map((el, i) => ({ idx: i, text: el.textContent }));
      const fuse = new Fuse(fuseList, {
        keys: ['text'],
        threshold: 0.4,
        distance: 200,
        minMatchCharLength: 2,
        ignoreLocation: true
      });
      searchInput.addEventListener('input', (e) => {
        const query = e.target.value.trim();
        if (!query) {
          items.forEach(el => el.style.display = '');
          document.querySelectorAll('.category-section').forEach(s => s.style.display = '');
          return;
        }
        const results = fuse.search(query);
        const matchedIdx = new Set(results.map(r => r.item.idx));
        items.forEach((el, i) => el.style.display = matchedIdx.has(i) ? '' : 'none');
        // Show/hide category sections based on visible cards
        document.querySelectorAll('.category-section').forEach(sec => {
          const hasVisible = sec.querySelectorAll('.card:not([style*="display: none"])').length > 0;
          sec.style.display = hasVisible ? '' : 'none';
        });
      });
    }
  </script>

  <!-- AI Guide Bot -->
  <div id="chatbot-fab" onclick="toggleChat()" style="position:fixed;bottom:24px;right:24px;width:56px;height:56px;border-radius:50%;background:#000;color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 4px 24px rgba(0,0,0,0.3);z-index:9999;font-size:20px;transition:all 0.3s;border:2px solid #333" onmouseover="this.style.transform='scale(1.08)';this.style.boxShadow='0 6px 28px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='scale(1)';this.style.boxShadow='0 4px 24px rgba(0,0,0,0.3)'">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
  </div>

  <div id="chatbot-panel" style="display:none;position:fixed;bottom:90px;right:24px;width:380px;max-height:540px;background:#fff;border:1px solid #e0e0e0;border-radius:16px;box-shadow:0 12px 48px rgba(0,0,0,0.15);z-index:9999;overflow:hidden;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif">
    <div style="padding:16px 20px;background:#000;color:#fff;display:flex;justify-content:space-between;align-items:center">
      <div style="display:flex;align-items:center;gap:10px">
        <div>
          <div style="font-weight:700;font-size:15px;letter-spacing:-0.3px">가이드봇</div>
          <div style="font-size:11px;color:#999;margin-top:2px">오류 해결 AI 어시스턴트</div>
        </div>
        <span id="usage-badge" style="padding:3px 8px;border-radius:8px;font-size:10px;font-weight:600;background:#f5f5f5;color:#666">3/3 무료</span>
      </div>
      <span onclick="toggleChat()" style="cursor:pointer;font-size:18px;color:#666;transition:color 0.2s" onmouseover="this.style.color='#fff'" onmouseout="this.style.color='#666'">✕</span>
    </div>
    <div id="chat-messages" style="height:340px;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:10px;background:#fafafa">
      <div style="background:#fff;padding:12px 16px;border-radius:14px;color:#333;font-size:13px;max-width:85%;box-shadow:0 1px 3px rgba(0,0,0,0.08);line-height:1.6">
        안녕하세요! 오류 증상을 설명해주시면<br>해결 방법을 안내해드릴게요.
      </div>
      <div style="display:flex;gap:6px;flex-wrap:wrap">
        <span onclick="quickQ(this)" style="background:#fff;border:1px solid #ddd;padding:6px 12px;border-radius:20px;font-size:11px;color:#555;cursor:pointer;transition:all 0.2s" onmouseover="this.style.borderColor='#000';this.style.color='#000'" onmouseout="this.style.borderColor='#ddd';this.style.color='#555'">설치 오류</span>
        <span onclick="quickQ(this)" style="background:#fff;border:1px solid #ddd;padding:6px 12px;border-radius:20px;font-size:11px;color:#555;cursor:pointer;transition:all 0.2s" onmouseover="this.style.borderColor='#000';this.style.color='#000'" onmouseout="this.style.borderColor='#ddd';this.style.color='#555'">연결 안됨</span>
        <span onclick="quickQ(this)" style="background:#fff;border:1px solid #ddd;padding:6px 12px;border-radius:20px;font-size:11px;color:#555;cursor:pointer;transition:all 0.2s" onmouseover="this.style.borderColor='#000';this.style.color='#000'" onmouseout="this.style.borderColor='#ddd';this.style.color='#555'">인증 오류</span>
        <span onclick="quickQ(this)" style="background:#fff;border:1px solid #ddd;padding:6px 12px;border-radius:20px;font-size:11px;color:#555;cursor:pointer;transition:all 0.2s" onmouseover="this.style.borderColor='#000';this.style.color='#000'" onmouseout="this.style.borderColor='#ddd';this.style.color='#555'">텔레그램 봇</span>
      </div>
    </div>
    <div style="padding:12px 16px;border-top:1px solid #eee;display:flex;gap:8px;background:#fff">
      <input id="chat-input" type="text" placeholder="오류 증상을 입력하세요..." onkeydown="if(event.key==='Enter')sendChat()" style="flex:1;padding:10px 16px;border-radius:24px;border:1px solid #ddd;background:#f5f5f5;color:#333;font-size:13px;outline:none;transition:border 0.2s" onfocus="this.style.borderColor='#000'" onblur="this.style.borderColor='#ddd'">
      <button onclick="sendChat()" style="padding:10px 18px;border-radius:24px;border:none;background:#000;color:#fff;cursor:pointer;font-size:13px;font-weight:600;transition:opacity 0.2s" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" style="vertical-align:middle"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
      </button>
    </div>
  </div>

  <script>
  function toggleChat() {
    const p = document.getElementById('chatbot-panel');
    p.style.display = p.style.display === 'none' ? 'block' : 'none';
    if (p.style.display === 'block') document.getElementById('chat-input')?.focus();
    checkUsage();
  }
  function quickQ(el) {
    document.getElementById('chat-input').value = el.textContent + ' 해결 방법 알려주세요';
    sendChat();
  }
  function getUsage() {
    const data = JSON.parse(localStorage.getItem('guidebot_usage') || '{}');
    const today = new Date().toISOString().slice(0,10);
    if (data.date !== today) return { date: today, count: 0, pro: data.pro || false };
    return data;
  }
  function setUsage(u) { localStorage.setItem('guidebot_usage', JSON.stringify(u)); }
  function checkUsage() {
    const u = getUsage();
    const remaining = Math.max(0, 3 - u.count);
    const badge = document.getElementById('usage-badge');
    if (!badge) return;
    if (u.pro) {
      badge.textContent = 'PRO 무제한';
      badge.style.background = '#000'; badge.style.color = '#fff';
    } else {
      badge.textContent = remaining + '/3 무료';
      badge.style.background = remaining > 0 ? '#f5f5f5' : '#000';
      badge.style.color = remaining > 0 ? '#666' : '#fff';
    }
  }
  function showPaywall() {
    const box = document.getElementById('chat-messages');
    box.innerHTML += `<div style="background:#fff;padding:16px;border-radius:14px;box-shadow:0 1px 3px rgba(0,0,0,0.08);text-align:center">
      <div style="font-size:20px;margin-bottom:8px">🔒</div>
      <div style="font-weight:700;color:#000;font-size:14px;margin-bottom:4px">무료 체험이 끝났습니다</div>
      <div style="color:#666;font-size:12px;margin-bottom:12px">월 $3로 무제한 AI 오류 진단을 이용하세요</div>
      <button onclick="subscribe()" style="width:100%;padding:12px;border-radius:12px;border:none;background:#000;color:#fff;font-size:14px;font-weight:600;cursor:pointer;transition:opacity 0.2s;margin-bottom:8px" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">구독하기 — $3/월</button>
      <div style="color:#999;font-size:11px">언제든 해지 가능 · 안전한 결제</div>
    </div>`;
    box.scrollTop = box.scrollHeight;
  }
  function subscribe() {
    // Creem checkout URL — replace with actual product link
    const creemUrl = 'https://www.creem.io/test/payment/prod_6nhRuGebUqLLtBkGJcHrNO';
    window.open(creemUrl, '_blank');
  }
  // Check for pro activation via URL param (after Creem redirect)
  (function() {
    const params = new URLSearchParams(window.location.search);
    if (params.get('pro') === 'activated') {
      const u = getUsage(); u.pro = true; setUsage(u);
      window.history.replaceState({}, '', window.location.pathname);
    }
  })();
  async function sendChat() {
    const input = document.getElementById('chat-input');
    const msg = input.value.trim();
    if (!msg) return;

    // Check usage
    const u = getUsage();
    if (!u.pro && u.count >= 3) { showPaywall(); input.value = ''; return; }

    const box = document.getElementById('chat-messages');
    box.innerHTML += '<div style="background:#000;padding:10px 16px;border-radius:14px;color:#fff;font-size:13px;max-width:85%;align-self:flex-end">'+msg.replace(/</g,'&lt;')+'</div>';
    input.value = '';
    box.innerHTML += '<div id="typing" style="background:#fff;padding:12px 16px;border-radius:14px;color:#999;font-size:13px;box-shadow:0 1px 3px rgba(0,0,0,0.08)"><span style="animation:pulse 1.5s infinite">분석 중</span><style>@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.4}}</style></div>';
    box.scrollTop = box.scrollHeight;

    try {
      const r = await fetch('/api/chat', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({ message: msg })
      });
      const d = await r.json();
      document.getElementById('typing')?.remove();
      if (d.error) throw new Error(d.error);
      let html = d.answer.replace(/</g,'&lt;').replace(/\*\*(.+?)\*\*/g,'<b>$1</b>').replace(/`([^`]+)`/g,'<code style="background:#f0f0f0;padding:2px 6px;border-radius:4px;font-size:12px;color:#333">$1</code>').replace(/\n/g,'<br>');
      box.innerHTML += '<div style="background:#fff;padding:12px 16px;border-radius:14px;color:#333;font-size:13px;max-width:85%;line-height:1.6;box-shadow:0 1px 3px rgba(0,0,0,0.08)">'+html+'</div>';
      // Update usage
      u.count++; setUsage(u); checkUsage();
    } catch(e) {
      document.getElementById('typing')?.remove();
      box.innerHTML += '<div style="background:#fff;border:1px solid #e0e0e0;padding:12px 16px;border-radius:14px;color:#c00;font-size:13px">일시적 오류가 발생했습니다. 다시 시도해주세요.</div>';
    }
    box.scrollTop = box.scrollHeight;
  }
  </script>
</body>
</html>